import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Connect to Amazon Polly',
  description:
    'Connect to Amazon Polly.',
  platforms: [
    'android',
    'angular',
    'flutter',
    'javascript',
    'nextjs',
    'react',
    'react-native',
    'swift',
    'vue'
  ]
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps() {
  return {
    props: {
      meta
    }
  };
}

Here's an introduction for Amazon Polly to add to the "Connect to Polly" documentation:

---

## Connect to Amazon Polly

Amazon Polly is a text-to-speech (TTS) service offered by Amazon Web Services (AWS). It uses advanced deep learning technologies to convert written text into lifelike speech, enabling you to create applications with speech capabilities in various languages and voices.

With Amazon Polly, you can easily add voice interactions and accessibility features to your applications. The service supports a wide range of use cases, such as providing audio content for the visually impaired, enhancing e-learning experiences, creating interactive voice response (IVR) systems, and more.

Key features of Amazon Polly include:

- **Multiple Voices and Languages**: Amazon Polly supports dozens of voices across various languages and dialects, giving you the flexibility to choose the most appropriate voice for your use case.

- **High-Quality Speech**: Amazon Polly's neural and standard voices offer natural and realistic speech quality.

- **Speech Marks and SSML**: Customize your speech output with Speech Synthesis Markup Language (SSML) tags and obtain speech timing information with speech marks.

- **Scalable and Cost-Effective**: Amazon Polly's pay-as-you-go pricing model makes it a cost-effective solution for adding speech capabilities to your applications.

In this section, you'll learn how to integrate Amazon Polly into your application using AWS Amplify, enabling you to leverage its powerful text-to-speech capabilities seamlessly.

### Setup the project

Setup the project by following the instructions in (Quickstart)[https://docs.amplify.aws/javascript/start/quickstart/] guide. 

### Install Polly Libraries
 To install the Amazon Polly library, run the following command in your projectâ€™s root folder:

```bash
npm install @aws-sdk/client-polly

```

### Setup Storage

By defining storage in your backend configuration, you can customize the access rules to different paths in your storage bucket.

First, create a file `amplify/storage/resource.ts`. Paste the following content into the file. Please refer to Storage section for additional information.

```ts title="amplify/storage/resource.ts"
import { defineStorage } from '@aws-amplify/backend';

export const storage = defineStorage({
  name: 'predictionsforgen2'
});

```

## Step 2 - Add your Amazon Polly as a source

### Define the Custom Mutation

Now that your 

### Configure the function handler 

To define the function, create a new file, `amplify/data/convertTextToSpeech.ts`. Then, define the Function with defineFunction: 

This function handler converts text into speech using Amazon Polly, a text-to-speech service from Amazon Web Services (AWS). The function takes in an event argument with a text input, and uses Amazon Polly to synthesize the text into an audio file in MP3 format. The synthesized speech is saved to an S3 bucket specified by the env.predictionsforgen2_BUCKET_NAME environment variable.

```ts title="amplify/data/convertTextToSpeech.ts"

import { Schema } from "./resource";
import { PollyClient, StartSpeechSynthesisTaskCommand } from '@aws-sdk/client-polly'
import { env } from '$amplify/env/convertTextToSpeech'

export const handler: Schema["convertTextToSpeech"]["functionHandler"] = async (event) => {
  const client = new PollyClient()
  const task = new StartSpeechSynthesisTaskCommand({
    OutputFormat: 'mp3',
    SampleRate: '8000',
    Text: event.arguments.text,
    TextType: 'text',
    VoiceId: 'Amy',
    OutputS3BucketName: env.predictionsforgen2_BUCKET_NAME,
    OutputS3KeyPrefix: 'public/'
  })
  const result = await client.send(task)

  return result.SynthesisTask?.OutputUri?.replace(
    'https://s3.us-east-1.amazonaws.com/' + env.predictionsforgen2_BUCKET_NAME + '/public/', "") ?? ""
}

```
