import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Copy files',
  description: 'Copy files using Amplify Storage',
  platforms: [
    'angular',
    'javascript',
    'nextjs',
    'react',
    'vue',
    'flutter'
  ]
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps(context) {
  return {
    props: {
      meta
    }
  };
}

<Callout>

**Note:** You can only copy files up to 5GB in a single operation

</Callout>

You can copy an existing file to a different path within the storage bucket using the copy API.

<InlineFilter filters={["angular","javascript","nextjs","react","vue"]}>

The `copy` method duplicates an existing file to a designated path and returns an object `{path: 'destPath'}` upon successful completion.

```javascript
import { copy } from 'aws-amplify/storage';

const copyFile = async () => {
  try {
    const response = await copy({
      source: {
        path: 'album/2024/1.jpg',
        // Alternatively, path: ({identityId}) => `album/{identityId}/1.jpg`
      },
      destination: {
        path: 'shared/2024/1.jpg',
        // Alternatively, path: ({identityId}) => `shared/{identityId}/1.jpg`
      },
    });
  } catch (error) {
    console.error('Error', err);
  }
};
```

<Callout>

Cross identity ID copying is only allowed if the source object's access level is set to 'protected'.

</Callout>

</InlineFilter>

<InlineFilter filters={["flutter"]}>

User who initiates a copy operation should have read permission on the copy source file.

```dart
import 'package:amplify_flutter/amplify_flutter.dart';

Future<void> copyGuestFileToPrivate({
  required String sourceKey,
  required String destinationKey,
}) async {
  try {
    final result = await Amplify.Storage.copy(
      source: StorageItemWithAccessLevel(
        storageItem: StorageItem(key: sourceKey),
        accessLevel: StorageAccessLevel.guest,
      ),
      destination: StorageItemWithAccessLevel(
        storageItem: StorageItem(key: destinationKey),
        accessLevel: StorageAccessLevel.private,
      ),
    ).result;

    safePrint('Copied file: ${result.copiedItem.key}');
  } on StorageException catch (e) {
    safePrint('Error copying file: ${e.message}');
    rethrow;
  }
}
```

</InlineFilter>
