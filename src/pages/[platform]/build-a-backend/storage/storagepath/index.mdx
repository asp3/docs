import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Using StoragePath',
  description: "Learn more about constructing a StoragePath to use on Amplify Storage APIs",
  platforms: [
    'swift',
    'android'
  ]
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps(context) {
  return {
    props: {
      platform: context.params.platform,
      meta
    }
  };
}

<InlineFilter filters={["android", "swift"]}>
You can now use `StoragePath` to explicitly access, upload, and download to any path in your S3 bucket.
Instead of using access levels, which restrict you to the predefined `guest`, `private`, or `public` folder in S3, `StoragePath` gives you more flexibility and control to create, maintain, and provision the path and storage structure that best fits your needs.

You can specify the path to your S3 resource by creating a `StoragePath` directly from a String, or by constructing the path with the user's Cognito IdentityId.

A `StoragePath` must: 

1. Not start with a '/' (leading slash)
2. Not be empty

## Create a StoragePath from String
When constructing a StoragePath from a String, the provided string will be the path.
</InlineFilter>

<InlineFilter filters={["swift"]}>
```swift
// Resolves to "public/exampleFile.txt"
StoragePath.fromString("public/exampleFile.txt")
```
</InlineFilter>

<InlineFilter filters={["android"]}>
  <BlockSwitcher>
    <Block name="Java">
    ```java
    // Resolves to "public/exampleFile.txt"
    StoragePath.fromString("public/exampleFile.txt") 
    ```
    </Block>

    <Block name="Kotlin">
      ```kotlin
      // Resolves to "public/exampleFile.txt"
      StoragePath.fromString("public/exampleFile.txt") 
      ```
    </Block>
  </BlockSwitcher>
</InlineFilter>

<InlineFilter filters={["android", "swift"]}>

## Create a StoragePath with user’s IdentityId
You may want to construct a StoragePath that contains the Amplify Auth user’s IdentityId. We’ve created a helper function that injects the user’s IdentityId when a Storage API is called, since fetching an IdentityId from the Auth plugin is not synchronous.
</InlineFilter>

<InlineFilter filters={["swift"]}>
```swift
// If the user's identityId was "123", 
// the StoragePath would resolve to "private/123/exampleFile.txt"
StoragePath.fromIdentityID { identityId in
  return "private/\(identityId)/exampleFile.txt"
}
```
</InlineFilter>

<InlineFilter filters={["android"]}>
  <BlockSwitcher>
    <Block name="Java">
    ```java
    // If the user's identityId was "123", 
    // the StoragePath would resolve to "private/123/exampleFile.txt"
    StoragePath.fromIdentityId(identityId -> 
      "private/" + identityId + "/exampleFile.txt"
    );
    ```
    </Block>

    <Block name="Kotlin">
    ```kotlin
    // If the user's identityId was "123", 
    // the StoragePath would resolve to "private/123/exampleFile.txt"
    StoragePath.fromIdentityId { identityId -> 
      "private/${identityId}/exampleFile.txt" 
    }
    ```
    </Block>
  </BlockSwitcher>
</InlineFilter>
